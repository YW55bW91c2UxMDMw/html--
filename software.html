<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>JINDOSTAR - Software Depot</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

    <style>
        /* ğŸŒŒ [JindoStar í•´ì  í…Œë§ˆ] */
        :root {
            --bg-deep: #050510;
            --accent: #00d4ff;       /* ì‹œì•ˆ (ê¸°ë³¸) */
            --premium: #ff4f6d;      /* ìœ ë£Œ (VIP) */
            --free: #00ff9d;         /* ë¬´ë£Œ (Safe) */
            --glass-bg: rgba(20, 20, 35, 0.8);
            --border: rgba(255, 255, 255, 0.1);
            --text-main: #eeeeee;
            --text-sub: #888888;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0; padding: 0;
            font-family: 'Pretendard', monospace; /* í•´í‚¹ ëŠë‚Œì„ ìœ„í•´ ê³ ì •í­ í°íŠ¸ ì‚¬ìš© */
            background-color: var(--bg-deep);
            color: var(--text-main);
            background-image: 
                linear-gradient(rgba(0, 255, 0, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 0, 0.03) 1px, transparent 1px);
            background-size: 30px 30px; /* ëª¨ëˆˆì¢…ì´ ê·¸ë¦¬ë“œ ë°°ê²½ */
            min-height: 100vh;
        }

        a { text-decoration: none; color: inherit; }

        /* ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */
        .top-bar {
            padding: 15px 20px;
            background: #000;
            border-bottom: 1px solid #333;
            display: flex; justify-content: space-between; align-items: center;
            position: fixed; top: 0; width: 100%; z-index: 100;
        }
        .logo { font-weight: 900; color: var(--accent); letter-spacing: 2px; }

        .container { max-width: 1000px; margin: 80px auto 40px auto; padding: 0 15px; }

        /* ê²€ìƒ‰ì°½ & í•„í„° */
        .search-box {
            display: flex; gap: 10px; margin-bottom: 20px;
            background: var(--glass-bg); padding: 15px; border-radius: 8px; border: 1px solid var(--border);
        }
        input {
            flex: 1; background: #000; border: 1px solid #444; color: #fff; padding: 10px;
            font-family: 'Pretendard', monospace; outline: none;
        }
        input:focus { border-color: var(--accent); }

        /* ğŸ´â€â˜ ï¸ í•´ì íŒ ìŠ¤íƒ€ì¼ í…Œì´ë¸” ë¦¬ìŠ¤íŠ¸ */
        .torrent-table {
            width: 100%; border-collapse: collapse;
            font-size: 0.9rem;
        }
        
        .torrent-table th {
            text-align: left; padding: 10px;
            background: rgba(255,255,255,0.05);
            color: var(--text-sub); font-size: 0.8rem;
            border-bottom: 2px solid #333;
        }

        .torrent-table td {
            padding: 12px 10px;
            border-bottom: 1px solid #222;
            vertical-align: middle;
        }

        .torrent-table tr:hover { background: rgba(255,255,255,0.02); }

        /* íƒ€ì… ì•„ì´ì½˜ */
        .type-icon { font-size: 1.2rem; margin-right: 5px; }

        /* ì œëª© & íƒœê·¸ */
        .prog-title { font-weight: bold; font-size: 1rem; display: block; margin-bottom: 3px; }
        .prog-meta { font-size: 0.75rem; color: var(--text-sub); }
        .vip-tag { 
            background: var(--premium); color: #000; font-weight: bold; font-size: 0.7rem; 
            padding: 2px 6px; border-radius: 3px; margin-left: 5px; 
        }
        .free-tag { 
            background: var(--free); color: #000; font-weight: bold; font-size: 0.7rem; 
            padding: 2px 6px; border-radius: 3px; margin-left: 5px; 
        }

        /* ë§ˆê·¸ë„·/ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ */
        .action-btn {
            display: inline-block; padding: 5px 10px;
            border: 1px solid #444; border-radius: 4px;
            font-size: 0.8rem; cursor: pointer; transition: 0.3s;
        }
        .btn-down { color: var(--free); border-color: var(--free); }
        .btn-down:hover { background: var(--free); color: black; }
        
        .btn-buy { color: var(--premium); border-color: var(--premium); }
        .btn-buy:hover { background: var(--premium); color: black; }

        /* ì‹œë”/ë¦¬ì²˜ (ì»¨ì…‰ìš©) */
        .seed { color: var(--free); font-weight: bold; }
        .leech { color: var(--premium); font-weight: bold; }

        /* ëª¨ë°”ì¼ ëŒ€ì‘ */
        @media (max-width: 600px) {
            .hide-mobile { display: none; }
            .prog-title { font-size: 0.9rem; }
        }
    </style>
</head>
<body>

    <div class="top-bar">
        <a href="/" class="logo">JINDO_WAREZ</a>
        <div style="font-size:0.8rem; color:#666;">CONNECTED: <span style="color:var(--free);">SECURE</span></div>
    </div>

    <div class="container">
        
        <div class="search-box">
            <input type="text" id="search-input" placeholder="Search programs, cracks, tools..." onkeyup="filterList()">
            <select id="filter-select" onchange="filterList()" style="background:#000; color:#fff; border:1px solid #444; padding:5px;">
                <option value="all">All Types</option>
                <option value="free">Free Only</option>
                <option value="premium">Premium Only</option>
            </select>
        </div>

        <table class="torrent-table">
            <thead>
                <tr>
                    <th width="50%">Name / Type</th>
                    <th width="10%" class="hide-mobile">Ver</th>
                    <th width="10%" class="hide-mobile">Size</th>
                    <th width="10%" class="hide-mobile">SE/LE</th>
                    <th width="20%" style="text-align:right;">Action</th>
                </tr>
            </thead>
            <tbody id="program-list">
                <tr><td colspan="5" style="text-align:center; padding:30px; color:#555;">Searching Database...</td></tr>
            </tbody>
        </table>

        <div style="margin-top:30px; text-align:center; font-size:0.8rem; color:#444;">
            WARNING: You are browsing a secure JindoStar mirror. <br>
            IP Logging Disabled. P2P Encrypted May be?
        </div>
    </div>

    <script>
        // 1. Supabase ì„¤ì •
        const supabaseUrl = 'https://podegnqsxajvtegplsvo.supabase.co'
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBvZGVnbnFzeGFqdnRlZ3Bsc3ZvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM1MzgyMjMsImV4cCI6MjA3OTExNDIyM30.uq9VhsOyJYDtarKIDAxGnoq_K1BHCOp4DFp57rUSEL4'
        const client = window.supabase.createClient(supabaseUrl, supabaseKey);

        let allPrograms = [];

        // 2. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadPrograms() {
            const { data, error } = await client
                .from('programs')
                .select('*')
                .order('created_at', { ascending: false });

            if (error) {
                console.error(error);
                document.getElementById('program-list').innerHTML = '<tr><td colspan="5">Error loading data</td></tr>';
                return;
            }

            allPrograms = data;
            renderList(data);
        }

        // 3. ë¦¬ìŠ¤íŠ¸ ê·¸ë¦¬ê¸°
        function renderList(data) {
            const list = document.getElementById('program-list');
            list.innerHTML = '';

            data.forEach(item => {
                // ìœ ë£Œ/ë¬´ë£Œ êµ¬ë¶„
                let badge = item.is_premium 
                    ? `<span class="vip-tag">VIP Only ($${item.price})</span>` 
                    : `<span class="free-tag">FreeLech</span>`;
                
                // ë²„íŠ¼ êµ¬ë¶„
                let btn = item.is_premium
                    ? `<a href="#" onclick="alert('ğŸ’³ ê²°ì œ ì‹œìŠ¤í…œ ì—°ë™ ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤.\\nê°€ê²©: ${item.price}ì›'); return false;" class="action-btn btn-buy">ğŸ›’ Buy</a>`
                    : `<a href="${item.download_url}" class="action-btn btn-down" download>ğŸ’¾ Download</a>`;
                
                // ë§ˆê·¸ë„· (ì»¨ì…‰)
                let magnet = item.magnet_link 
                    ? `<a href="${item.magnet_link}" title="Magnet Link">ğŸ§²</a>` 
                    : ``;

                // ê°€ì§œ ì‹œë”/ë¦¬ì²˜ ìƒì„± (ëœë¤)
                let se = item.seeders || Math.floor(Math.random() * 500);
                let le = Math.floor(Math.random() * 50);

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <div style="display:flex; align-items:center;">
                            <span class="type-icon">${item.is_premium ? 'ğŸ’' : 'ğŸ“¦'}</span>
                            <div>
                                <a href="#" class="prog-title">${item.title} ${badge}</a>
                                <div class="prog-meta">Uploaded ${new Date(item.created_at).toLocaleDateString()} | by JindoStar</div>
                            </div>
                        </div>
                    </td>
                    <td class="hide-mobile" style="color:var(--accent);">${item.version}</td>
                    <td class="hide-mobile">${item.size}</td>
                    <td class="hide-mobile"><span class="seed">${se}</span> / <span class="leech">${le}</span></td>
                    <td style="text-align:right;">
                        ${magnet}
                        ${btn}
                    </td>
                `;
                list.appendChild(tr);
            });
        }

        // 4. ê²€ìƒ‰ ë° í•„í„°ë§
        function filterList() {
            const keyword = document.getElementById('search-input').value.toLowerCase();
            const type = document.getElementById('filter-select').value;

            const filtered = allPrograms.filter(item => {
                // ê²€ìƒ‰ì–´ ì²´í¬
                const matchKeyword = item.title.toLowerCase().includes(keyword);
                
                // íƒ€ì… ì²´í¬
                let matchType = true;
                if (type === 'free') matchType = !item.is_premium;
                if (type === 'premium') matchType = item.is_premium;

                return matchKeyword && matchType;
            });

            renderList(filtered);
        }

        loadPrograms();
    </script>

</body>
</html>