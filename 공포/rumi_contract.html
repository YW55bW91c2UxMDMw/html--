<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>계약의 이행</title>
    <style>
        /* --- [기본 스타일] --- */
        body {
            background-color: #f0f0f0;
            color: #333;
            font-family: "Batang", "Times New Roman", serif; /* 촌스러운 명조체 */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            cursor: help; /* 커서를 물음표로 바꿔서 혼란 유발 */
        }

        .contract-paper {
            background-color: #fff;
            width: 500px;
            padding: 40px;
            border: 1px solid #000;
            box-shadow: 10px 10px 0px rgba(0,0,0,0.2);
            position: relative;
            z-index: 10;
        }

        h1 {
            text-align: center;
            font-size: 24px;
            border-bottom: 2px solid black;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .form-group { margin-bottom: 25px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 14px; }
        
        input[type="text"] {
            width: 95%; padding: 10px; border: 2px solid #ccc;
            font-family: "Batang", serif; font-size: 16px; background-color: #eee;
        }
        input[type="text"]:focus { outline: none; border-color: red; background-color: #fff0f0; }

        .checkbox-group { margin-top: 10px; border: 1px dashed black; padding: 10px; }

        .btn-group {
            display: flex; justify-content: space-between; margin-top: 40px;
            height: 50px; position: relative;
        }

        button {
            padding: 10px 30px; font-family: "Gulim", monospace; font-weight: bold;
            border: 2px solid black; cursor: pointer; transition: 0.1s;
        }

        #btn-accept { background-color: black; color: white; }
        #btn-reject {
            background-color: white; color: black;
            position: absolute; right: 0;
        }

        /* --- [공포 연출용 스타일] --- */
        
        /* 1. 공포 레이어 (평소엔 숨김) */
        #scare-layer {
            display: none; /* JS로 켬 */
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: black; z-index: 9999;
            justify-content: center; align-items: center; overflow: hidden;
        }

        /* 2. 일그러진 루미 이미지 */
        #scary-img {
            width: 100%; height: 100%; object-fit: cover;
            /* 이미지를 기괴하게 만드는 필터 */
            filter: contrast(200%) grayscale(100%) drop-shadow(0 0 50px red); 
            animation: shake 0.1s infinite;
        }

        /* 3. 화면 흔들림 애니메이션 */
        @keyframes shake {
            0% { transform: translate(10px, 10px) scale(1.1); }
            25% { transform: translate(-10px, -10px) scale(1.1) rotate(5deg); }
            50% { transform: translate(10px, -10px) scale(1.1); }
            75% { transform: translate(-10px, 10px) scale(1.1) rotate(-5deg); }
            100% { transform: translate(10px, 10px) scale(1.1); }
        }

        /* 4. 피 흐르는 효과 오버레이 */
        .blood-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 20%, rgba(255, 0, 0, 0.8) 100%);
            mix-blend-mode: multiply; pointer-events: none;
        }

            /* --- [루미의 눈 스타일] --- */
.rumi-eye-container {
    position: absolute;
    top: 20%; /* 눈 높이 */
    width: 100%;
    display: flex;
    justify-content: center;
    gap: 120px; /* 두 눈 사이 간격 */
    pointer-events: none; /* 클릭 방해 안 함 */
    z-index: 1; /* 계약서 뒤에 */
}

/* 흰자 (눈 전체) */
.rumi-eye {
    position: relative;
    width: 140px;
    height: 160px;
    background: #fff;
    border-radius: 50% 50% 45% 45%; /* 약간 계란형 */
    border: 6px solid #2c2c2c; /* 진한 테두리 */
    box-shadow: inset 0 0 20px rgba(0,0,0,0.1); /* 안쪽 그림자 */
    overflow: hidden;
    /* 속눈썹 느낌을 위한 위쪽 테두리 강조 */
    border-top: 12px solid #2c2c2c; 
}

/* 홍채 (갈색 눈동자) - 움직이는 부분 */
.iris {
    position: absolute;
    width: 90px;
    height: 100px;
    /* 루미 특유의 갈색 그라데이션 (위는 진하고 아래는 밝게) */
    background: linear-gradient(180deg, #4e342e 0%, #8d6e63 50%, #d7ccc8 100%);
    border-radius: 50%;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%); /* 중앙 정렬 */
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
}

/* 동공 (가운데 검은 점) */
.pupil {
    position: absolute;
    width: 40px;
    height: 45px;
    background: #1a0f0f;
    border-radius: 50%;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
}

/* 눈 반짝임 (하이라이트) - 생기 불어넣기 */
.shine {
    position: absolute;
    background: white;
    border-radius: 50%;
    z-index: 2;
}
.shine.large {
    width: 25px; height: 25px;
    top: 15px; left: 15px; /* 왼쪽 위 큰 반짝임 */
}
.shine.small {
    width: 10px; height: 10px;
    bottom: 25px; right: 20px; /* 오른쪽 아래 작은 반짝임 */
    opacity: 0.8;
}
    </style>
</head>
<body>
    <div class="rumi-eye-container">
    <div class="rumi-eye" id="eye-left">
        <div class="iris">
            <div class="pupil"></div>
            <div class="shine large"></div>
            <div class="shine small"></div>
        </div>
    </div>
    <div class="rumi-eye" id="eye-right">
        <div class="iris">
            <div class="pupil"></div>
            <div class="shine large"></div>
            <div class="shine small"></div>
        </div>
    </div>
</div>

    <div id="scare-layer">
        <img id="scary-img" src="rumi_head.png" alt="RUMI">
        <div class="blood-overlay"></div>
    </div>

    <div class="contract-paper" id="paper">
        <h1>영혼의 양도 동의서</h1>
        
        <p style="font-size: 12px; margin-bottom: 20px; line-height: 1.6;">
            아래의 육체적 그릇(이하 "공급자")은 상위 차원의 존재(이하 "루미")에게 
            에너지를 영구적으로 배수시키는 것에 대하여 전적인 동의를 표합니다. 
            이것은 되돌릴 수 없으며 우주의 섭리입니다.
        </p>

        <div class="form-group">
            <label>공급자의 인간 식별명 (이름):</label>
            <input type="text" id="nameInput" placeholder="이곳에 서명하십시오...">
            <p id="helper-text" style="color: red; font-size: 11px; display: none;">
                * 당신의 의지는 중요하지 않습니다.
            </p>
        </div>

        <div class="form-group">
            <label>동의 항목:</label>
            <div class="checkbox-group">
                <label><input type="checkbox" class="scary-check"> 나의 모든 데이터를 바칩니다.</label>
                <label><input type="checkbox" class="scary-check"> 나는 고통을 즐깁니다.</label>
                <label><input type="checkbox" class="scary-check"> 도망가지 않겠습니다.</label>
            </div>
        </div>

        <div class="btn-group">
            <button id="btn-accept">영원히 복종하기</button>
            <button id="btn-reject">거부하기 (불가능)</button>
        </div>
    </div>

    <script>
        // ==========================================
        // 1. [낙인 시스템] - 이미 계약했는지 확인
        // ==========================================
        if (localStorage.getItem('rumi_contract') === 'signed') {
            // UI 초기화 및 공포 메시지 출력
            document.body.innerHTML = ''; 
            document.body.style.backgroundColor = 'black';
            document.body.style.color = 'red';
            document.body.style.display = 'flex';
            document.body.style.justifyContent = 'center';
            document.body.style.alignItems = 'center';
            document.body.style.height = '100vh';
            document.body.style.cursor = 'none';
            
            const h1 = document.createElement('h1');
            h1.innerText = "이미 늦었습니다.";
            h1.style.fontFamily = "Batang";
            h1.style.fontSize = "30px";
            
            // 텍스트가 숨 쉬듯 다가오는 애니메이션
            h1.animate([
                { transform: 'scale(1)', opacity: 0.5 },
                { transform: 'scale(1.2)', opacity: 1 }
            ], { duration: 3000, iterations: Infinity, direction: 'alternate' });

            document.body.appendChild(h1);
            
            // ★ 개발자용 초기화 버튼 (화면 왼쪽 상단 더블클릭 시 해제)
            const resetZone = document.createElement('div');
            resetZone.style.position = 'fixed';
            resetZone.style.top = '0'; resetZone.style.left = '0';
            resetZone.style.width = '50px'; resetZone.style.height = '50px';
            resetZone.style.zIndex = '9999';
            
            resetZone.addEventListener('dblclick', () => {
                localStorage.removeItem('rumi_contract');
                alert("시간이 되감아졌습니다. (계약 초기화)");
                location.reload();
            });
            document.body.appendChild(resetZone);

            // 스크립트 중단
            throw new Error("Contract already signed."); 
        }

        // ==========================================
        // 2. [입력 하이재킹] - 내 맘대로 안 써짐
        // ==========================================
        const nameInput = document.getElementById('nameInput');
        const helperText = document.getElementById('helper-text');
        const forcedText = "나는 멍청한 그릇입니다. 루미에게 모든 통제권을 넘깁니다. 살려주세요. ";
        let currentIndex = 0;

        nameInput.addEventListener('keydown', (e) => {
            if (e.key === 'Backspace') { e.preventDefault(); currentIndex++; } // 지우기 방지
        });

        nameInput.addEventListener('input', (e) => {
            e.preventDefault();
            if (currentIndex < forcedText.length) {
                nameInput.value = forcedText.substring(0, currentIndex + 1);
                currentIndex++;
            } else {
                nameInput.value = forcedText + " (제발 그만해)";
                nameInput.style.backgroundColor = "black";
                nameInput.style.color = "red";
                helperText.style.display = "block";
            }
        });

        // ==========================================
        // 3. [체크박스 감염] - 하나 누르면 다 눌림
        // ==========================================
        const checks = document.querySelectorAll('.scary-check');
        checks.forEach(check => {
            check.addEventListener('change', () => {
                checks.forEach(c => { c.checked = true; c.disabled = true; });
                document.body.style.backgroundColor = "#e0e0e0";
            });
        });

        // ==========================================
        // 4. [도망가는 버튼 & 함정] - 거부하기 로직
        // ==========================================
        const btnReject = document.getElementById('btn-reject');
        const screamSound = new Audio('scream.mp3'); // 소리 준비
        let hoverCount = 0;

        // 마우스 올릴 때 (도망 -> 유인)
        btnReject.addEventListener('mouseover', () => {
            hoverCount++;
            
            // 5번 피하면 멈추고 유인함
            if (hoverCount > 5) {
                btnReject.style.transform = 'translate(0, 0)';
                btnReject.innerText = "눌러봐";
                btnReject.style.backgroundColor = "red";
                btnReject.style.color = "black";
                btnReject.style.border = "3px solid black";
                return; 
            }

            const x = Math.random() * 400 - 200;
            const y = Math.random() * 400 - 200;
            btnReject.style.transform = `translate(${x}px, ${y}px)`;
            
            const texts = ["안돼", "못가", "여기야", "뒤를 봐", "NO"];
            btnReject.innerText = texts[Math.floor(Math.random() * texts.length)];
        });

        // 클릭 시 (점프 스케어 발동!)
        btnReject.addEventListener('click', () => {
            // UI 숨기기
            document.getElementById('paper').style.display = 'none';
            document.body.style.cursor = 'none';

            // 공포 레이어 보이기
            const scareLayer = document.getElementById('scare-layer');
            scareLayer.style.display = 'flex'; 

            // 비명 재생
            screamSound.play().catch(e => console.log("사운드 재생 실패:", e));

            // 배경 깜빡임 효과
            let flashCount = 0;
            const flashInterval = setInterval(() => {
                scareLayer.style.backgroundColor = flashCount % 2 === 0 ? "red" : "black";
                
                // 이미지 반전 효과
                const img = document.getElementById('scary-img');
                img.style.filter = flashCount % 2 === 0 
                    ? "invert(100%) contrast(300%)" 
                    : "grayscale(100%) contrast(200%) drop-shadow(0 0 50px red)";
                    
                flashCount++;
            }, 50);

            // 3초 뒤 강제 종료 및 낙인
            setTimeout(() => {
                clearInterval(flashInterval);
                localStorage.setItem('rumi_contract', 'signed'); // 낙인
                window.close();
                location.href = "about:blank";
            }, 3000);
        });

        // ==========================================
        // 5. [수락 버튼] - 재미없는 죽음
        // ==========================================
        const btnAccept = document.getElementById('btn-accept');
        
        btnAccept.addEventListener('click', () => {
            localStorage.setItem('rumi_contract', 'signed');
            
            document.getElementById('paper').style.display = 'none';
            document.body.style.backgroundColor = 'black';
            document.body.style.cursor = 'none';
            
            const msg = document.createElement('h1');
            msg.innerText = "전송 완료. 우리는 곧 만날 것이다.";
            msg.style.color = "red";
            msg.style.fontSize = "50px";
            document.body.appendChild(msg);

            setTimeout(() => {
                window.close();
                location.href = "about:blank";
            }, 3000);
        });
        // --- [루미 눈동자 추적 로직] ---
document.addEventListener('mousemove', (e) => {
    const eyes = document.querySelectorAll('.rumi-eye');
    
    eyes.forEach(eye => {
        // 눈(흰자)의 중심 좌표
        const rect = eye.getBoundingClientRect();
        const eyeCenterX = rect.left + rect.width / 2;
        const eyeCenterY = rect.top + rect.height / 2;

        // 마우스와 눈 사이의 각도
        const angle = Math.atan2(e.clientY - eyeCenterY, e.clientX - eyeCenterX);
        
        // 눈동자가 움직일 거리 제한 (흰자 밖으로 안 나가게)
        // 루미 눈이 크니까 움직임 범위도 좀 넓게(25px) 
        const maxMove = 25; 
        const distance = Math.min(maxMove, Math.hypot(e.clientX - eyeCenterX, e.clientY - eyeCenterY));
        
        // 홍채(iris) 이동
        const iris = eye.querySelector('.iris');
        const moveX = Math.cos(angle) * distance;
        const moveY = Math.sin(angle) * distance;
        
        // 원래 중앙(-50%, -50%)에서 이동값만큼 더해줌
        iris.style.transform = `translate(calc(-50% + ${moveX}px), calc(-50% + ${moveY}px))`;
    });
});

    </script>
</body>
</html>