<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë£¨ë¯¸ì˜ ë¯¸ê¶ (Escape Rumi)</title>
    <style>
        /* --- ê²Œì„ ìŠ¤íƒ€ì¼ --- */
        body {
            background-color: #222;
            color: white;
            font-family: 'Courier New', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            user-select: none;
        }

        #game-container {
            width: 800px;
            height: 600px;
            background-color: #FFD1DC;
            border: 10px solid #555;
            position: relative;
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
            overflow: hidden;
        }

        /* --- UI ìš”ì†Œ --- */
        #inventory-bar {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 60px;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            padding-left: 20px;
            font-size: 14px;
            border-top: 2px solid white;
            z-index: 100;
        }

        .scene {
            width: 100%;
            height: 100%;
            position: absolute;
            display: none;
        }
        .scene.active { display: block; }

        /* --- ì˜¤ë¸Œì íŠ¸ (í´ë¦­ ê°€ëŠ¥í•œ ê²ƒë“¤) --- */
        .obj {
            position: absolute;
            cursor: pointer;
            transition: 0.2s;
        }
        .obj:hover { 
            filter: drop-shadow(0 0 5px yellow); 
            transform: scale(1.05); /* ë§ˆìš°ìŠ¤ ì˜¬ë¦¬ë©´ ì»¤ì§ (í´ë¦­ ìœ ë„) */
        }

        /* ë£¨ë¯¸ ìºë¦­í„° */
        #rumi {
            width: 200px;
            bottom: 80px;
            left: 350px; /* ìœ„ì¹˜ë¥¼ ì•½ê°„ ì˜¤ë¥¸ìª½ìœ¼ë¡œ */
            transition: 0.5s;
            z-index: 10; /* ë£¨ë¯¸ ë†’ì´ */
        }

        /* ë¬¸ */
        .door { 
            width: 120px; height: 200px; 
            background: #8B4513; bottom: 80px; 
            border: 5px solid #5c2e0b; 
            z-index: 5;
        }
        
        /* [ìˆ˜ì •ë¨] ëŸ¬ê·¸ ìŠ¤íƒ€ì¼ - í´ë¦­ ì˜ ë˜ê²Œ ë³€ê²½ */
        .rug { 
            width: 250px; height: 80px; /* í¬ê¸° í‚¤ì›€ */
            background: #FF69B4; 
            bottom: 30px; 
            left: 50px; /* ë£¨ë¯¸ì™€ ì•ˆ ê²¹ì¹˜ê²Œ ì™¼ìª½ìœ¼ë¡œ ì´ë™ */
            border-radius: 50%; 
            border: 2px solid #C71585; /* í…Œë‘ë¦¬ ì¶”ê°€í•´ì„œ ì˜ ë³´ì´ê²Œ */
            z-index: 20; /* ë£¨ë¯¸ë³´ë‹¤ ì•ìœ¼ë¡œ ì˜¤ê²Œ ì„¤ì • (ì¤‘ìš”) */
        }

        /* ìª½ì§€ */
        .poster { 
            width: 80px; height: 100px; 
            background: white; top: 50px; left: 100px; 
            border: 2px solid black; color: black; 
            display: flex; justify-content: center; align-items: center; 
            font-size: 10px; text-align: center;
            z-index: 5;
        }

        /* í‚¤íŒ¨ë“œ UI */
        #keypad-overlay {
            display: none;
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 150;
            justify-content: center; align-items: center; flex-direction: column;
        }
        #keypad-input { font-size: 30px; padding: 10px; text-align: center; margin-bottom: 20px; }
        .key-btn { padding: 10px 20px; font-size: 20px; cursor: pointer; }

        /* --- ê³µí¬ ì—°ì¶œ --- */
        #jumpscare-layer {
            display: none;
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: black; z-index: 9999;
            justify-content: center; align-items: center;
        }
        #scary-face {
            width: 100%; height: 100%; object-fit: cover;
            filter: contrast(200%) grayscale(100%) drop-shadow(0 0 50px red);
            animation: shake 0.1s infinite;
        }
        /* ì—´ì‡  ì•„ì´í…œ (ìˆ˜ì •ë¨: z-indexë¥¼ 25ë¡œ ë†’ì—¬ì„œ ëŸ¬ê·¸ë³´ë‹¤ ìœ„ì— ë³´ì´ê²Œ í•¨) */
#key-item {
    display: none;
    bottom: 50px; left: 150px;
    font-size: 50px;
    z-index: 25; /* ì¤‘ìš”! ëŸ¬ê·¸(20)ë³´ë‹¤ ë†’ì•„ì•¼ ë³´ì„ */
    animation: bounce 1s infinite; /* ì˜ ë³´ì´ê²Œ ë‘¥ì‹¤ë‘¥ì‹¤ íš¨ê³¼ ì¶”ê°€ */
}

/* ì—´ì‡  ê°•ì¡° ì• ë‹ˆë©”ì´ì…˜ */
@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

    </style>
</head>
<body>

    <div id="game-container">
        
        <div id="room1" class="scene active">
            <div style="position:absolute; top:20px; width:100%; text-align:center; color:#ff1493; font-weight:bold;">ROOM 1: THE PLAYROOM</div>
            
            <div class="door obj" style="right: 100px;" onclick="tryOpenDoor()"></div>
            
            <div class="rug obj" onclick="liftRug()"></div>
            
            <div id="key-item" class="obj" onclick="getKey()">ğŸ”‘</div>
            
            <img id="rumi" class="obj" src="rumi_idle.png" onclick="clickRumi()">

            <div class="poster obj" onclick="readNote()">Rules</div>
        </div>

        <div id="room2" class="scene" style="background-color: #333;">
            <div style="position:absolute; top:20px; width:100%; text-align:center; color:red; font-weight:bold;">ROOM 2: DARK HALLWAY</div>
            
            <div class="door obj" style="left: 350px; background: #300; border-color: red;" onclick="showKeypad()"></div>
            
            <div style="position:absolute; top:150px; left:100px; color:red; font-size:20px; transform: rotate(-10deg);">
                RUMI EYES = ?
            </div>
            
            <img class="obj" src="rumi_idle.png" style="width:150px; bottom:80px; right:50px; filter: grayscale(100%) contrast(300%);" onclick="die('ê±´ë“œë¦¬ì§€ ë§ì•˜ì–´ì•¼ í–ˆë‹¤.')">
        </div>

        <div id="inventory-bar">
            ì†Œì§€í’ˆ: <span id="inv-list" style="margin-left: 10px; color: yellow;">ì—†ìŒ</span>
        </div>

        <div id="keypad-overlay">
            <h2 style="color:red;">SECURITY LOCK</h2>
            <input type="text" id="keypad-input" placeholder="CODE">
            <div style="margin-top:10px;">
                <button class="key-btn" onclick="checkCode()">UNLOCK</button>
                <button class="key-btn" onclick="document.getElementById('keypad-overlay').style.display='none'">CANCEL</button>
            </div>
        </div>

    </div>

    <div id="jumpscare-layer">
        <img id="scary-face" src="rumi_idle.png">
    </div>

    <script>
        let inventory = [];
        let rumiClickCount = 0;
        const screamSound = new Audio('scream.mp3');

        // 1. ì•„ì´í…œ íšë“
        function getKey() {
            document.getElementById('key-item').style.display = 'none';
            inventory.push("í”¼ ë¬»ì€ ì—´ì‡ ");
            updateInventory();
            alert("ì—´ì‡ ë¥¼ ì–»ì—ˆë‹¤. ë­”ê°€ ëˆì ê±°ë¦°ë‹¤...");
        }

        // 2. ì¸ë²¤í† ë¦¬ UI ì—…ë°ì´íŠ¸
        function updateInventory() {
            const list = document.getElementById('inv-list');
            list.innerText = inventory.join(", ");
        }

function liftRug() {
    const rug = document.querySelector('.rug');
    
    // ëŸ¬ê·¸ë¥¼ í™”ë©´ ìœ„ë¡œ íœ™ ë‚ ë ¤ë²„ë¦¼ (íˆ¬ëª…ë„ ì¡°ì ˆ í¬í•¨)
    rug.style.transform = "translateY(-200px) rotate(45deg)";
    rug.style.opacity = "0.5"; 
    
    // ì—´ì‡ ê°€ ì—†ìœ¼ë©´ ë³´ì´ê²Œ í•¨
    if (!inventory.includes("í”¼ ë¬»ì€ ì—´ì‡ ")) {
        document.getElementById('key-item').style.display = 'block';
    }
}

        // 4. ìª½ì§€ ì½ê¸°
        function readNote() {
            alert("ìª½ì§€ ë‚´ìš©:\n\n'ë£¨ë¯¸ê°€ ë°°ê³ íŒŒ ë³´ì—¬ë„ ë¨¹ì´ë¥¼ ì£¼ì§€ ë§ˆì‹œì˜¤.'\n'ê·¸ë…€ì˜ ëˆˆì„ ë„ˆë¬´ ì˜¤ë˜ ë°”ë¼ë³´ì§€ ë§ˆì‹œì˜¤.'");
        }

        // 5. ë£¨ë¯¸ í´ë¦­
        function clickRumi() {
            rumiClickCount++;
            const rumi = document.getElementById('rumi');

            if (rumiClickCount < 3) {
                alert("ë£¨ë¯¸: 'ì–´ë”” ê°€ë ¤ê³ ? ë‚˜ë‘ ë†€ì!'");
                rumi.style.transform = "scale(1.1)";
                setTimeout(() => rumi.style.transform = "scale(1)", 200);
            } else if (rumiClickCount < 6) {
                rumi.style.filter = "grayscale(50%)";
                alert("ë£¨ë¯¸ì˜ í‘œì •ì´ êµ³ì–´ì¡Œë‹¤.\n'ë‚˜ë¥¼ ë‘ê³  ê°ˆ ê±°ì•¼?'");
            } else {
                die("ë£¨ë¯¸ê°€ ë‹¹ì‹ ì˜ ì†ëª©ì„ ë¬¼ì–´ëœ¯ì—ˆìŠµë‹ˆë‹¤.");
            }
        }

        // 6. 1ë²ˆë°© ë¬¸ ì—´ê¸°
        function tryOpenDoor() {
            if (inventory.includes("í”¼ ë¬»ì€ ì—´ì‡ ")) {
                alert("ì—´ì‡ ë¡œ ë¬¸ì„ ì—´ì—ˆë‹¤.");
                changeScene('room2');
            } else {
                alert("ë¬¸ì´ ì ê²¨ìˆë‹¤. ì—´ì‡  êµ¬ë©ì—ì„œ ë¶‰ì€ ì•¡ì²´ê°€ í˜ëŸ¬ë‚˜ì˜¨ë‹¤.");
            }
        }

        // 7. ì”¬ ì´ë™
        function changeScene(sceneId) {
            document.querySelectorAll('.scene').forEach(s => s.classList.remove('active'));
            document.getElementById(sceneId).classList.add('active');
            
            if(sceneId === 'room2') {
                document.getElementById('game-container').style.borderColor = "red";
            }
        }

        // 8. í‚¤íŒ¨ë“œ
        function showKeypad() {
            document.getElementById('keypad-overlay').style.display = 'flex';
        }

        function checkCode() {
            const input = document.getElementById('keypad-input').value;
            // ì •ë‹µ: 2 (ë£¨ë¯¸ ëˆˆ ê°œìˆ˜)
            if (input === "2") { 
                document.getElementById('keypad-overlay').style.display = 'none';
                alert("ì ê¸ˆì´ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤... íƒˆì¶œêµ¬ëŠ” ì—†ìŠµë‹ˆë‹¤.");
                location.reload(); 
            } else {
                die("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤. ê²½ë³´ìŒì´ ìš¸ë¦½ë‹ˆë‹¤.");
            }
        }

        // ê³µí¬ ì—°ì¶œ
        function die(reason) {
            screamSound.play().catch(()=>{});
            const layer = document.getElementById('jumpscare-layer');
            layer.style.display = 'flex';
            setTimeout(() => {
                alert(`GAME OVER\nì‚¬ì¸: ${reason}`);
                location.reload();
            }, 2000);
        }
    </script>
</body>
</html>